# T√©cnicas de Machine Learning

O processo de constru√ß√£o, uso e manuten√ß√£o de modelos de machine learning e os dados que eles usam √© um processo muito diferente de muitos outros fluxos de trabalho de desenvolvimento. Nesta li√ß√£o, vamos desmistificar o processo e delinear as principais t√©cnicas que voc√™ precisa saber. Voc√™ ir√°:

- Compreender os processos que sustentam o aprendizado de m√°quina em alto n√≠vel.
- Explorar conceitos b√°sicos como 'modelos', 'previs√µes' e 'dados de treinamento'..

## [Question√°rio pr√©-aula](https://white-water-09ec41f0f.azurestaticapps.net/quiz/7?loc=ptbr)

## Introdu√ß√£o

Em um alto n√≠vel, a arte de criar processos de machine learning (ML) √© composta por uma s√©rie de etapas:

1. **Decida sobre a quest√£o**. A maioria dos processos de ML come√ßa fazendo uma pergunta que n√£o pode ser respondida por um simples programa condicional ou mecanismo baseado em regras. Essas quest√µes geralmente giram em torno de previs√µes baseadas em uma cole√ß√£o de dados.
2. **Colete e prepare dados**. Para responder √† sua pergunta, voc√™ precisa de dados. A qualidade e, √†s vezes, a quantidade de seus dados determinar√£o o qu√£o bem voc√™ pode responder √† sua pergunta inicial. A visualiza√ß√£o de dados √© um aspecto importante desta fase. Esta fase tamb√©m inclui a divis√£o dos dados em um grupo de treinamento e teste para construir um modelo.
3. **Escolha um m√©todo de treinamento**. Dependendo da sua pergunta e da natureza dos seus dados, voc√™ precisa escolher como deseja treinar um modelo para melhor refletir seus dados e fazer previs√µes precisas em rela√ß√£o a eles. Esta √© a parte do seu processo de ML que requer conhecimentos espec√≠ficos e, muitas vezes, uma quantidade consider√°vel de experimenta√ß√£o.
4. **Treine o modelo**. Usando seus dados de treinamento, voc√™ usar√° v√°rios algoritmos para treinar um modelo para reconhecer padr√µes nos dados. O modelo pode alavancar pesos internos que podem ser ajustados para privilegiar certas partes dos dados sobre outras para construir um modelo melhor.
5. **Avalie o modelo**. Voc√™ usa dados nunca antes vistos (seus dados de teste) de seu conjunto coletado para ver como o modelo est√° se saindo.
6. **Ajuste de par√¢metros**. Com base no desempenho do seu modelo, voc√™ pode refazer o processo usando diferentes par√¢metros, ou vari√°veis, que controlam o comportamento dos algoritmos usados para treinar o modelo.
7. **Preveja**. Use novas entradas para testar a precis√£o do seu modelo.

## Que pergunta fazer

Os computadores s√£o particularmente adeptos da descoberta de padr√µes ocultos nos dados. Esse recurso √© muito √∫til para pesquisadores que t√™m d√∫vidas sobre um determinado campo que n√£o podem ser respondidas facilmente criando um mecanismo de regras baseado em condi√ß√µes. Dada uma tarefa atuarial, por exemplo, um cientista de dados pode ser capaz de construir manualmente regras sobre a mortalidade de fumantes versus n√£o fumantes.

Quando muitas outras vari√°veis ‚Äã‚Äãs√£o introduzidas na equa√ß√£o, no entanto, um modelo de ML pode ser mais eficiente para prever as taxas de mortalidade futuras com base no hist√≥rico de sa√∫de anterior. Um exemplo mais alegre seria fazer previs√µes do tempo de abril para um determinado local com base em dados que incluem latitude, longitude, mudan√ßa clim√°tica, proximidade do oceano, padr√µes de fluxo de jato e muito mais.

‚úÖ Esta [apresenta√ß√£o](https://www2.cisl.ucar.edu/sites/default/files/0900%20June%2024%20Haupt_0.pdf) sobre modelos meteorol√≥gicos oferece uma perspectiva hist√≥rica do uso do ML na an√°lise meteorol√≥gica.

## Tarefas de pr√©-constru√ß√£o

Antes de come√ßar a construir seu modelo, h√° v√°rias tarefas que voc√™ precisa concluir. Para testar sua pergunta e formar uma hip√≥tese com base nas previs√µes de um modelo, voc√™ precisa identificar e configurar v√°rios elementos.

### Dados

Para poder responder √† sua pergunta com qualquer tipo de certeza, voc√™ precisa de uma boa quantidade de dados do tipo certo. H√° duas coisas que voc√™ precisa fazer neste momento:

- **Coletar dados**. Tendo em mente a li√ß√£o anterior sobre justi√ßa na an√°lise de dados, colete seus dados com cuidado. Esteja ciente das fontes desses dados, de quaisquer tend√™ncias inerentes que possam ter e documente sua origem.
- **Prepare os dados**. Existem v√°rias etapas no processo de prepara√ß√£o de dados. Pode ser necess√°rio agrupar dados e normaliz√°-los se vierem de fontes diversas. Voc√™ pode melhorar a qualidade e a quantidade dos dados por meio de v√°rios m√©todos, como a convers√£o de strings em n√∫meros (como fazemos em [Clustering](../../../5-Clustering/1-Visualize/README.md)). Voc√™ tamb√©m pode gerar novos dados, com base no original (como fazemos em [Classifica√ß√£o](../../../4-Classification/1-Introduction/README.md)). Voc√™ pode limpar e editar os dados (como faremos antes da li√ß√£o[Web App](../../../3-Web-App/README.md)). Finalmente, voc√™ tamb√©m pode precisar randomiz√°-lo e embaralh√°-lo, dependendo de suas t√©cnicas de treinamento.

‚úÖ Depois de coletar e processar seus dados, reserve um momento para ver se o formato permitir√° que voc√™ responda √† pergunta pretendida. Pode ser que os dados n√£o funcionem bem em sua tarefa, como descobrimos em nossas li√ß√µes de [Clustering](../../../5-Clustering/1-Visualize/README.md)!

### Recursos e Alvo

Um [recurso](https://www.datasciencecentral.com/profiles/blogs/an-introduction-to-variable-and-feature-selection) √© uma propriedade mensur√°vel de seus dados. Em muitos conjuntos de dados, √© expresso como um cabe√ßalho de coluna como 'data', 'tamanho' ou 'cor'. Sua vari√°vel de recurso, geralmente representada como `X` no c√≥digo, representa a vari√°vel de entrada que ser√° usada para treinar o modelo.

Um alvo √© algo que voc√™ est√° tentando prever. Alvo geralmente representado como `y` no c√≥digo, representa a resposta √† pergunta que voc√™ est√° tentando fazer sobre seus dados: em Dezembro, quais ab√≥boras de **cor**ser√£o mais baratas? em S√£o Francisco, quais bairros ter√£o o melhor **pre√ßo** imobili√°rio? √Äs vezes, o destino tamb√©m √© conhecido como atributo de r√≥tulo.

### Selecionando sua vari√°vel de caracter√≠stica

üéì **Sele√ß√£o e extra√ß√£o de recursos** Como voc√™ sabe qual vari√°vel escolher ao construir um modelo? Voc√™ provavelmente passar√° por um processo de sele√ß√£o ou extra√ß√£o de recursos para escolher as vari√°veis certas para o modelo de melhor desempenho. Eles n√£o s√£o a mesma coisa, no entanto: "A extra√ß√£o de recursos cria novos recursos a partir de fun√ß√µes dos recursos originais, enquanto a sele√ß√£o de recursos retorna um subconjunto dos recursos." ([fonte](https://wikipedia.org/wiki/Feature_selection))

### Visualize seus dados

Um aspecto importante do kit de ferramentas de uma pessoa cientista de dados √© o poder de visualizar dados usando v√°rias bibliotecas excelentes, como Seaborn ou MatPlotLib. A representa√ß√£o visual de seus dados pode permitir que voc√™ descubra correla√ß√µes ocultas que voc√™ pode explorar. As visualiza√ß√µes tamb√©m podem ajudar a descobrir distor√ß√µes ou dados desequilibrados (como encontrado em[Classifica√ß√£o](../../../4-Classification/2-Classifiers-1/README.md)).

### Divida seu conjunto de dados

Antes do treinamento, voc√™ precisa dividir seu conjunto de dados em duas ou mais partes de tamanhos desiguais que ainda representam bem os dados.

- **Treinamento**. Esta parte do conjunto de dados √© adequada ao seu modelo para trein√°-lo. Este conjunto constitui a maior parte do conjunto de dados original.
- **Teste**. Um conjunto de dados de teste √© um grupo independente de dados, geralmente coletado dos dados originais, que voc√™ usa para confirmar o desempenho do modelo constru√≠do.
- **Validando**. Um conjunto de valida√ß√£o √© um grupo menor independente de exemplos que voc√™ usa para ajustar os hiperpar√¢metros do modelo, ou arquitetura, para melhorar o modelo. Dependendo do tamanho dos seus dados e da pergunta que voc√™ est√° fazendo, pode n√£o ser necess√°rio construir este terceiro conjunto (como observamos em [Previs√£o de s√©rie temporal](../../../7-TimeSeries/1-Introduction/README.md)).

## Construindo um modelo

Usando seus dados de treinamento, sua meta √© construir um modelo, ou uma representa√ß√£o estat√≠stica de seus dados, usando v√°rios algoritmos para **trein√°-los**. O treinamento de um modelo o exp√µe aos dados e permite que ele fa√ßa suposi√ß√µes sobre os padr√µes percebidos que descobre, valida e aceita ou rejeita.

### Decidir sobre um m√©todo de treinamento

Desvendando da sua pergunta e da natureza dos seus dados, voc√™ escolher√° um m√©todo para trein√°-los. Percorrendo a [documenta√ß√£o do Scikit-learn](https://scikit-learn.org/stable/user_guide.html) - que usamos neste curso - voc√™ pode explorar muitas maneiras de treinar um modelo. Dependendo da sua experi√™ncia, pode ser necess√°rio tentar v√°rios m√©todos diferentes para construir o melhor modelo. √â prov√°vel que voc√™ passe por um processo pelo qual os cientistas de dados avaliam o desempenho de um modelo, alimentando-o com dados invis√≠veis, verificando a precis√£o, o vi√©s e outros problemas que degradam a qualidade e selecionando o m√©todo de treinamento mais apropriado para a tarefa em quest√£o.

### Treine um modelo

Armado com seus dados de treinamento, voc√™ est√° pronto para 'ajust√°-los' para criar um modelo. Voc√™ notar√° que em muitas bibliotecas de ML voc√™ encontrar√° o c√≥digo 'model.fit' - √© neste momento que voc√™ envia sua vari√°vel de recurso como uma matriz de valores (geralmente 'X') e uma vari√°vel de destino (geralmente 'y').

### Avalie o modelo

Assim que o processo de treinamento for conclu√≠do (pode levar muitas itera√ß√µes, ou 'epochs', para treinar um modelo grande), voc√™ poder√° avaliar a qualidade do modelo usando dados de teste para avaliar seu desempenho. Esses dados s√£o um subconjunto dos dados originais que o modelo n√£o analisou anteriormente. Voc√™ pode imprimir uma tabela de m√©tricas sobre a qualidade do seu modelo.

üéì **Adapta√ß√£o do modelo**

No contexto do machine learning, o ajuste do modelo refere-se √† precis√£o da fun√ß√£o subjacente do modelo √† medida que tenta analisar dados com os quais n√£o est√° familiarizado.

üéì **Underfitting** e **overfitting** s√£o problemas comuns que degradam a qualidade do modelo, pois o modelo n√£o se ajusta bem o suficiente ou se ajusta muito bem. Isso faz com que o modelo fa√ßa previs√µes muito alinhadas ou muito vagamente alinhadas com seus dados de treinamento. Um modelo de ajuste excessivo prev√™ os dados de treinamento muito bem porque aprendeu os detalhes e o ru√≠do dos dados muito bem. Um modelo insuficiente n√£o √© preciso, pois n√£o pode analisar com precis√£o seus dados de treinamento, nem os dados que ainda n√£o foram 'visto'.

![modelo de overfitting](../images/overfitting.png)
> Infogr√°fico por [Jen Looper](https://twitter.com/jenlooper)

## Ajuste de par√¢metro

Quando o treinamento inicial estiver conclu√≠do, observe a qualidade do modelo e considere melhor√°-lo ajustando seus 'hiperpar√¢metros'. Leia mais sobre o processo [na documenta√ß√£o](https://docs.microsoft.com/en-us/azure/machine-learning/how-to-tune-hyperparameters?WT.mc_id=academic-15963-cxa).

## Predi√ß√£o

Este √© o momento em que voc√™ pode usar dados completamente novos para testar a precis√£o do seu modelo. Em uma configura√ß√£o de ML 'aplicada', onde voc√™ est√° construindo ativos da web para usar o modelo na produ√ß√£o, este processo pode envolver a coleta de entrada do usu√°rio (um pressionamento de bot√£o, por exemplo) para definir uma vari√°vel e envi√°-la ao modelo para infer√™ncia, ou avalia√ß√£o.

Nessas li√ß√µes, voc√™ descobrir√° como usar essas etapas para preparar, criar, testar, avaliar e prever - todos os gestos de uma pessoa cientista de dados e muito mais, conforme voc√™ avan√ßa em sua jornada para se tornar um engenheiro de ML de 'full stack'.

---

## üöÄDesafio

Desenhe um fluxograma refletindo as etapas de um praticante de ML. Onde voc√™ se v√™ agora no processo? Onde voc√™ prev√™ que encontrar√° dificuldade? O que parece f√°cil para voc√™?

## [Question√°rio p√≥s-aula](https://white-water-09ec41f0f.azurestaticapps.net/quiz/8?loc=ptbr)

## Revis√£o e Autoestudo

Procure por entrevistas online com  pessoas cientistas de dados que discutem seu trabalho di√°rio. Aqui est√° [uma](https://www.youtube.com/watch?v=Z3IjgbbCEfs).

## Tarefa

[Entreviste uma pessoa cientista de dados](assignment.pt-br.md)